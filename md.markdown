## 系统整体架构说明

系统采用多线程+消息队列架构，模块间通过消息队列异步通信，通过触摸屏交互实现主菜单切换、功能模块独立运行。
预留系统可能用到的其它类型消息接口，必要时可扩展功能模块间消息传递。

---

### 1. 系统启动流程

系统启动后，主循环创建消息队列和各功能线程，触摸监测线程负责采集触摸事件，主菜单模块等待用户操作。  
当检测到特定区域点击（如“电子相册”），通过消息队列发送切换命令，主循环接收后切换状态并启动对应功能线程。

![系统启动流程图](boot_flow.png)

---

### 2. 触摸事件处理流程

触摸屏硬件产生原始事件（X/Y/按下/释放），监测线程将其转换为手势（点击/滑动），并通过消息队列发送到主循环或功能模块。  
功能模块根据收到的坐标和手势类型执行相应操作。

![触摸事件处理流程](touch_flow.png)

---

### 3. 主循环与模块切换流程

主循环负责管理系统状态，根据消息队列中的命令切换当前运行的功能模块（如主菜单、电子相册、音频播放器等）。  
每个模块以独立线程运行，退出后主循环根据最新状态创建新线程，实现模块间的动态切换。

![主循环与模块切换流程](thread_change_flow.png)

---

### 总结

- **主循环**：负责系统状态管理和模块切换
- **消息队列**：实现模块间异步通信
- **触摸监测线程**：采集并分发触摸事件
- **功能模块线程**：独立运行，互不干扰